var App=function(){"use strict";var n={},i={init:function(){this.$body=$("body"),this.$message=this.$body.find(".rds-message"),this.$errmessage=this.$body.find(".rds-errmessage"),this.$btnExit=$(".rds-site-header-btn-exit"),this.$loader=$(".rds-loader"),this.NOW_LOADING=!1,console.log("hello!"),this.behavior()},behavior:function(){var n=this;this.$btnExit.on("touchend click",(function(){return n.exit(),!1}))},now_loading:function(){this.NOW_LOADING=!0,this.$body.addClass("now-loading")},end_loading:function(){this.NOW_LOADING=!1,this.$body.removeClass("now-loading")},exit:function(){this.AJAX=$.ajax({url:"rds/lib/rds.logout.php?callback=?",dataType:"jsonp",data:{},method:"POST",success:function(n){n.error?console.log(n.error):(console.log("OK!"),location.reload())},error:function(n){console.log("err:",n)}})},errmessage:function(n){this.$message.hide(),this.$errmessage.hide().html(n).fadeIn()},message:function(n){this.$errmessage.hide(),this.$message.hide().html(n).fadeIn()}},t={init:function(){this.$form=$(".enter"),this.$btnEnter=this.$form.find("button"),this.$inputLogin=this.$form.find("input[name=admin_login]"),this.$inputPass=this.$form.find("input[name=admin_pass]"),this.behavior()},behavior:function(){var n=this;this.$btnEnter.on("touchend click",(function(){return n.try_enter(),!1}))},try_enter:function(){if(this.$inputLogin.val()&&this.$inputPass.val()){var i=URLSITE.base+"rds/lib/rds.rdsadmin.php",t=this.$inputLogin.val(),r=this.$inputPass.val();console.log("url",i),this.AJAX=$.ajax({url:i+"?callback=?",dataType:"jsonp",data:{login:t,md5pass:n.RDS_MD5(r)},method:"POST",success:function(n){n.error?console.log(n.error):(console.log("OK!"),location.reload())},error:function(n){console.log("err enter",n)}})}else console.log("enter email and password")}},r={init:function(){this.$form=$(".rds-user-list"),this.$btnDel=this.$form.find("a.del-user"),this.$btnToArchive=this.$form.find("a.to-archive"),this.$btnFromArchive=this.$form.find("a.from-archive"),this.behavior()},behavior:function(){var n=this,i=function(i){confirm("Удалить пользователя ID:"+i+"?")&&!n.NOW_LOADING&&n.del(i)},t=function(i){confirm("Поместить кафе "+i+" в архив?")&&!n.NOW_LOADING&&n.to_archive(i)},r=function(i){confirm("Достать кафе "+i+" из архива?")&&!n.NOW_LOADING&&n.from_archive(i)};this.$btnDel.each((function(n){$(this).on("click",(function(){return i($(this).data("id-user")),!1}))})),this.$btnToArchive.each((function(n){$(this).on("click",(function(){return t($(this).data("id-cafe")),!1}))})),this.$btnFromArchive.each((function(n){$(this).on("click",(function(){return r($(this).data("id-cafe")),!1}))}))},to_archive:function(i){n.RDSAdmin.message("Отправка кафе "+i+" в архив"),n.RDSAdmin.now_loading();this.AJAX=$.ajax({url:"rds/lib/rds.cafe_to_archive.php?callback=?",dataType:"jsonp",data:{id_cafe:i},method:"POST",success:function(i){console.log(i),n.RDSAdmin.end_loading(),i&&!i.error?location.reload():n.RDSAdmin.errmessage(i.error)},error:function(i){console.log(i),n.RDSAdmin.end_loading(),n.RDSAdmin.errmessage(i)}})},from_archive:function(i){n.RDSAdmin.message("Возвращение кафе "+i+" из архива"),n.RDSAdmin.now_loading();this.AJAX=$.ajax({url:"rds/lib/rds.cafe_from_archive.php?callback=?",dataType:"jsonp",data:{id_cafe:i},method:"POST",success:function(i){console.log(i),n.RDSAdmin.end_loading(),i&&!i.error?location.reload():n.RDSAdmin.errmessage(i.error)},error:function(i){console.log(i),n.RDSAdmin.end_loading(),n.RDSAdmin.errmessage(i)}})},del:function(i){n.RDSAdmin.message("Отправка запроса на удаление пользователя с ID:"+i),n.RDSAdmin.now_loading();this.AJAX=$.ajax({url:"rds/lib/rds.order_del_user.php?callback=?",dataType:"jsonp",data:{id_user:i},method:"POST",success:function(t){if(console.log(t),n.RDSAdmin.end_loading(),t&&!t.error){var r="Отправлен запрос на удаление пользователя c ID:"+i;n.RDSAdmin.message(r)}else n.RDSAdmin.errmessage(t.error)},error:function(i){console.log(i),n.RDSAdmin.end_loading(),n.RDSAdmin.errmessage(i)}})}},o={init:function(){this.$btn=$(".btn-activate-contract"),this.behavior()},behavior:function(){var n=this;this.$btn.on("touchend click",(function(i){var t=$(this).data("contract-name"),r=$(this).data("id-user"),o=$(this).data("id-cafe");return confirm("Активировать контракт №"+t+"?")&&!n.NOW_LOADING&&n.activate_contract(t,r,o),!1}))},activate_contract:function(i,t,r){n.RDSAdmin.message("Активация договора "+i),n.RDSAdmin.now_loading();var o={contract_name:i,id_user:t,id_cafe:r};this.AJAX=$.ajax({url:"rds/lib/rds.contract_activate.php?callback=?",dataType:"jsonp",data:o,method:"POST",success:function(i){n.RDSAdmin.end_loading(),i&&!i.error?(console.log(i),location.reload()):n.RDSAdmin.errmessage(i.error)},error:function(i){console.log("!!!"),console.log(i),n.RDSAdmin.errmessage(JSON.stringify(i)),n.RDSAdmin.end_loading()}})}};function e(n,i,t,r,o,e){return l(function(n,i){return n<<i|n>>>32-i}(l(l(i,n),l(r,e)),o),t)}function a(n,i,t,r,o,a,s){return e(i&t|~i&r,n,i,o,a,s)}function s(n,i,t,r,o,a,s){return e(i&r|t&~r,n,i,o,a,s)}function c(n,i,t,r,o,a,s){return e(i^t^r,n,i,o,a,s)}function d(n,i,t,r,o,a,s){return e(t^(i|~r),n,i,o,a,s)}function l(n,i){var t=(65535&n)+(65535&i);return(n>>16)+(i>>16)+(t>>16)<<16|65535&t}return n.RDSAdmin=i,n.RDSEnter=t,n.RDSUserList=r,n.RDSAddContract=o,n.RDS_MD5=function(n){var i=function(n){for(var i,t="0123456789ABCDEF",r="",o=0;o<n.length;o++)i=n.charCodeAt(o),r+=t.charAt(i>>>4&15)+t.charAt(15&i);return r}(function(n){for(var i="",t=0;t<32*n.length;t+=8)i+=String.fromCharCode(n[t>>5]>>>t%32&255);return i}(function(n,i){n[i>>5]|=128<<i%32,n[14+(i+64>>>9<<4)]=i;for(var t=1732584193,r=-271733879,o=-1732584194,e=271733878,h=0;h<n.length;h+=16){var u=t,f=r,m=o,g=e;r=d(r=d(r=d(r=d(r=c(r=c(r=c(r=c(r=s(r=s(r=s(r=s(r=a(r=a(r=a(r=a(r,o=a(o,e=a(e,t=a(t,r,o,e,n[h+0],7,-680876936),r,o,n[h+1],12,-389564586),t,r,n[h+2],17,606105819),e,t,n[h+3],22,-1044525330),o=a(o,e=a(e,t=a(t,r,o,e,n[h+4],7,-176418897),r,o,n[h+5],12,1200080426),t,r,n[h+6],17,-1473231341),e,t,n[h+7],22,-45705983),o=a(o,e=a(e,t=a(t,r,o,e,n[h+8],7,1770035416),r,o,n[h+9],12,-1958414417),t,r,n[h+10],17,-42063),e,t,n[h+11],22,-1990404162),o=a(o,e=a(e,t=a(t,r,o,e,n[h+12],7,1804603682),r,o,n[h+13],12,-40341101),t,r,n[h+14],17,-1502002290),e,t,n[h+15],22,1236535329),o=s(o,e=s(e,t=s(t,r,o,e,n[h+1],5,-165796510),r,o,n[h+6],9,-1069501632),t,r,n[h+11],14,643717713),e,t,n[h+0],20,-373897302),o=s(o,e=s(e,t=s(t,r,o,e,n[h+5],5,-701558691),r,o,n[h+10],9,38016083),t,r,n[h+15],14,-660478335),e,t,n[h+4],20,-405537848),o=s(o,e=s(e,t=s(t,r,o,e,n[h+9],5,568446438),r,o,n[h+14],9,-1019803690),t,r,n[h+3],14,-187363961),e,t,n[h+8],20,1163531501),o=s(o,e=s(e,t=s(t,r,o,e,n[h+13],5,-1444681467),r,o,n[h+2],9,-51403784),t,r,n[h+7],14,1735328473),e,t,n[h+12],20,-1926607734),o=c(o,e=c(e,t=c(t,r,o,e,n[h+5],4,-378558),r,o,n[h+8],11,-2022574463),t,r,n[h+11],16,1839030562),e,t,n[h+14],23,-35309556),o=c(o,e=c(e,t=c(t,r,o,e,n[h+1],4,-1530992060),r,o,n[h+4],11,1272893353),t,r,n[h+7],16,-155497632),e,t,n[h+10],23,-1094730640),o=c(o,e=c(e,t=c(t,r,o,e,n[h+13],4,681279174),r,o,n[h+0],11,-358537222),t,r,n[h+3],16,-722521979),e,t,n[h+6],23,76029189),o=c(o,e=c(e,t=c(t,r,o,e,n[h+9],4,-640364487),r,o,n[h+12],11,-421815835),t,r,n[h+15],16,530742520),e,t,n[h+2],23,-995338651),o=d(o,e=d(e,t=d(t,r,o,e,n[h+0],6,-198630844),r,o,n[h+7],10,1126891415),t,r,n[h+14],15,-1416354905),e,t,n[h+5],21,-57434055),o=d(o,e=d(e,t=d(t,r,o,e,n[h+12],6,1700485571),r,o,n[h+3],10,-1894986606),t,r,n[h+10],15,-1051523),e,t,n[h+1],21,-2054922799),o=d(o,e=d(e,t=d(t,r,o,e,n[h+8],6,1873313359),r,o,n[h+15],10,-30611744),t,r,n[h+6],15,-1560198380),e,t,n[h+13],21,1309151649),o=d(o,e=d(e,t=d(t,r,o,e,n[h+4],6,-145523070),r,o,n[h+11],10,-1120210379),t,r,n[h+2],15,718787259),e,t,n[h+9],21,-343485551),t=l(t,u),r=l(r,f),o=l(o,m),e=l(e,g)}return Array(t,r,o,e)}(function(n){for(var i=Array(n.length>>2),t=0;t<i.length;t++)i[t]=0;for(t=0;t<8*n.length;t+=8)i[t>>5]|=(255&n.charCodeAt(t/8))<<t%32;return i}(n),8*n.length)));return i.toLowerCase()},function(){$((function(){n.RDSAdmin.init(),n.RDSEnter.init(),n.RDSUserList.init(),n.RDSAddContract.init()}))}}();
