!function(){"use strict";$.extend({supportsPassive:function(){var e=!1;try{var t=Object.defineProperty({},"passive",{get:function(){e=!0}});window.addEventListener("testPassive",null,t),window.removeEventListener("testPassive",null,t)}catch(e){}return e}}),$.fn.swipe=function(e){var t,n,i,s=$.extend({preventDefault:!0,enableMouse:!0,distance:100,fastSwipe:!0,onTouch:function(e){},onMove:function(e){},onSwipe:function(e){console.log("onSwipe!!")},onEnd:function(){}},e||{});return this.each((function(){var e,a,o,r,c=$(this),l=!1,_={touchStart:function(n){if(!(n.targetTouches.length>1)){i=!1;var c=n.targetTouches[0];o=c.pageX,r=c.pageY,e=c.pageX,a=c.pageY,t=new Date,s.onTouch({clientX:c.clientX,clientY:c.clientY,pageX:c.pageX,pageY:c.pageY,screenX:c.screenX,screenY:c.screenY})}},mouseDown:function(n){i=!1,l=!0,o=n.pageX,r=n.pageY,e=n.pageX,a=n.pageY,t=new Date,s.onTouch({clientX:n.clientX,clientY:n.clientY,pageX:n.pageX,pageY:n.pageY,screenX:n.screenX,screenY:n.screenY}),s.preventDefault&&n.preventDefault()},mouseMove:function(t){l&&(s.onMove({deltaX:t.pageX-e,deltaY:t.pageY-a,clientX:t.clientX,clientY:t.clientY,pageX:t.pageX,pageY:t.pageY,screenX:t.screenX,screenY:t.screenY}),e=t.pageX,a=t.pageY),s.fastSwipe&&!i&&_.testSwipe(),s.preventDefault&&t.preventDefault()},moveEnd:function(e){l&&(l=!1,!i&&_.testSwipe()),s.preventDefault&&e.preventDefault(),s.onEnd()},touchEnd:function(e){l=!1,!i&&_.testSwipe(),s.onEnd()},touchMove:function(t){if(!(t.targetTouches.length>1)){var n=t.targetTouches[0];s.onMove({deltaX:n.pageX-e,deltaY:n.pageY-a,clientX:n.clientX,clientY:n.clientY,pageX:n.pageX,pageY:n.pageY,screenX:n.screenX,screenY:n.screenY,evt:t}),e=n.pageX,a=n.pageY,s.preventDefault&&t.preventDefault(),s.fastSwipe&&!i&&_.testSwipe()}},testSwipe:function(){var c=e-o,l=a-r;if(n=Math.abs(new Date-t)/1e3,Math.abs(c)>=Math.abs(l)){if(Math.abs(c)>=s.distance){i=!0;var _=c>=0?"right":"left";s.onSwipe({direction:_,distance:Math.abs(c),speed:Math.abs(c)/n,time:n})}}else if(Math.abs(l)>=s.distance){i=!0;_=l>=0?"down":"up";s.onSwipe({direction:_,distance:Math.abs(l),speed:Math.abs(l)/n,time:n})}},touchCancel:function(e){}};s.enableMouse&&(c.mousedown((function(e){1==((e=e||window.event).keyCode||e.which)&&_.mouseDown(e)})),c.mouseup(_.moveEnd),$("body").mouseup(_.moveEnd),c.mousemove(_.mouseMove)),this.addEventListener("touchstart",_.touchStart,!!$.supportsPassive()&&{passive:!0}),this.addEventListener("touchmove",_.touchMove,!!$.supportsPassive()&&{passive:!0}),this.addEventListener("touchend",_.touchEnd),this.addEventListener("touchcancel",_.touchCancel)}))},$.fixIOSscroll=function(e){var t=0,n=function(e){t=e.targetTouches[0].clientY},i=function(e){var n=e.targetTouches[0].clientY,i=$(e.currentTarget).scrollTop(),s=t-n<0?"up":"down";0==i&&"up"==s?e.cancelable&&e.preventDefault():i>=e.currentTarget.scrollHeight-$(e.currentTarget).outerHeight()&&"down"==s&&e.cancelable&&e.preventDefault(),t=n};return e[0].addEventListener("touchstart",n,!!$.supportsPassive()&&{passive:!0}),e[0].addEventListener("touchmove",i,!!$.supportsPassive()&&{passive:!0}),this},$.extend({repos51:function(e){return new function(){var t={init:function(){var t=this;this.ALLROWS=e.ALLROWS,this.BUTTONS=e.BUTTONS||{},this.need2save=e.need2save||function(){},this.onTouchend=e.onTouchend||function(){},this.onRepose=e.onRepose||function(){},this.getRowIcon=e.getRowIcon,this.onReady=e.onReady,this.$parent_old=e.$parent,this.CLASS_NAME="repos-51",this.BUTTON_WIDTH=80,this.BUTTONS.left&&$.each(this.BUTTONS.left,(function(){this.btnClass=t.CLASS_NAME+"__"+this.btnClass})),this.BUTTONS.right&&$.each(this.BUTTONS.right,(function(){this.btnClass=t.CLASS_NAME+"__"+this.btnClass})),this.BUTTONS_HAVE_OPENED=!1,this.reset(),this.build(),this.behavior()},reset:function(){this.CURRENT_DRAG=0,this.OVER_DRAG=0,this.START_DRAG=!1,this.START_Y=0,this.CURR_Y=0,this.BEHAVIORS_MODE=!0,this.TOUCH_MOVED=!1,this.ROW_HEIGHT=null,this.PARENT_OFFSET_TOP=null,this.CURRENT_DELTA=0},get_row_height:function(){return this.ROW_HEIGHT=this.ROW_HEIGHT?this.ROW_HEIGHT:this.$rowSample.height(),this.ROW_HEIGHT},get_index_by_id:function(e){for(var t=-1,n=0;n<this.ALLROWS.length;n++)if(parseInt(this.ALLROWS[n].id,10)==parseInt(e,10)){t=n;break}return t},get_index_row:function(e){this.PARENT_OFFSET_TOP=null!==this.PARENT_OFFSET_TOP?this.PARENT_OFFSET_TOP:this.$parent.offset().top;var t=(this.PARENT_OFFSET_TOP-e-this.$parent.scrollTop())/this.get_row_height(),n=Math.floor(Math.abs(t));return n=(n=t>0?0:n)<this.ALLROWS.length?n:this.ALLROWS.length-1},build:function(){var e=this;this.$parent_old.html(""),this.$parent=$("<div></div>").addClass(this.$parent_old.attr("class")),this.$parent_old.parent().append(this.$parent),this.$parent_old.html("").remove(),this.$rowSample=$("<div>",{class:this.CLASS_NAME+"__row-sample"}),this.$wrapper=$("<div>",{class:this.CLASS_NAME+"-wrapper"}),this.$parent.append(this.$rowSample),this.$wrapper.html(""),this.update_height_content(),$.each(e.ALLROWS,(function(t){var n=e.build_new_row(t,this);e.$wrapper.append(n)})),this.ROWS_LINKS=this.$wrapper.find("."+e.CLASS_NAME+"__row").toArray(),this.$parent.append(this.$wrapper)},build_new_row:function(e,t){var n=this,i=function(e){if(!n.BUTTONS.left)return!1;var t=n.BUTTONS.left.length*n.BUTTON_WIDTH,i=$("<div>",{class:n.CLASS_NAME+"__row-buttons-left"}).css({width:t,left:-t});return $.each(n.BUTTONS.left,(function(t){var s=this.btnAction,a=this.btnClass||"",o=["<div class='ico-adm-delete'></div>","<div></div>"].join("");$("<div>",{class:n.CLASS_NAME+"__row_button "+a}).html(o).on("touchstart",(function(t){return $(this).hasClass(n.CLASS_NAME+"__btn-delete")||n.rowCloseAll(),s&&s(e,n),t.originalEvent.cancelable&&t.preventDefault(),!1})).appendTo(i)})),i},s=function(e){if(!n.BUTTONS.right)return!1;var t=n.BUTTONS.right.length*n.BUTTON_WIDTH,i=$("<div>",{class:n.CLASS_NAME+"__row-buttons-right"}).css({width:t,right:-t});return $.each(n.BUTTONS.right,(function(t){var s=this.btnAction,a=this.btnClass||"",o=["<div class='ico-adm-edit'></div>","<div></div>"].join("");$("<div>",{class:n.CLASS_NAME+"__row_button "+a}).html(o).on("touchstart",(function(t){return $(this).hasClass(n.CLASS_NAME+"__btn-edit")||n.rowCloseAll(),s&&s(e,n),t.originalEvent.cancelable&&t.preventDefault(),!1})).appendTo(i)})),i},a=t.title?t.title:t,o=t.id?t.id:0,r=parseInt(t.id_icon,10),c=n.getRowIcon?n.getRowIcon(r).className:"",l=n.get_row_height()*e,_="height:"+n.get_row_height()+"px;top:"+l+"px";const h=t.visible<1?"menu-hidden":"";var u=$([`<div class="${n.CLASS_NAME}__row ${h}" row-id="${o}" style="${_}">`,`<div class="${n.CLASS_NAME}__title">`,`<div class="${n.CLASS_NAME}__title_icon ${c}"></div>`,`<div class="${n.CLASS_NAME}__title_text">${a}</div></div>`,'<div class="icon-hidden ico-adm-hidden"></div>',"</div>"].join(""));return n.BUTTONS.left&&u.append(i(o)),n.BUTTONS.right&&u.append(s(o)),u},update_height_content:function(e){var t=this.ALLROWS.length*this.get_row_height();e&&e.slow?(this.$wrapper.css({height:t,transition:".3s"}),setTimeout((function(){e&&e.onReady&&e.onReady()}),300)):(this.$wrapper.css({height:t}),e&&e.onReady&&e.onReady())},update_menu:function(e){var t=parseInt(e.id_icon,10),n=this.get_index_by_id(e.id),i=$(this.ROWS_LINKS[n]);if(i.find("."+this.CLASS_NAME+"__title_text").html(e.title),e.visible<1?i.addClass("menu-hidden"):i.removeClass("menu-hidden"),this.getRowIcon){var s=i.find("."+this.CLASS_NAME+"__title_icon"),a=this.getRowIcon(t).className,o=this.getRowIcon();$.each(o,(function(){s.removeClass(this.className)})),s.addClass(a)}},add_menu:function(e){parseInt(e.id_icon,10);var t=this.ALLROWS.length-1,n=this.build_new_row(t,e);this.$wrapper.append(n),this.ROWS_LINKS.push(n[0]),this.update_height_content()},ios_scroll_safely:function(){var e=this.$parent.height(),t=this.$parent.find(".repos-51__row"),n=t.size()*t.eq(0).height(),i=this.$parent.scrollTop(),s=Math.abs(n-e);return i>-1&&i<s+1},behavior:function(){var e=this,t=function(t){if(!e.BEHAVIORS_MODE)return!1;if(t.targetTouches.length>1)return!1;e.TOUCH_MOVED=!1;var n=t.targetTouches[0],i=e.get_index_row(n.pageY);if(e.ROW_HAVE_TOCHED=i,null===i)return!1;e.TMR_LONG_PRESS&&clearTimeout(e.TMR_LONG_PRESS),e.TMR_LONG_PRESS=setTimeout((function(){if(!e.ios_scroll_safely())return!1;e.BUTTONS_HAVE_OPENED&&e.rowCloseAll(),e.START_SCROLLTOP=e.$parent.scrollTop(),e.START_DRAG=!0,e.CURRENT_DRAG=i,e.OVER_DRAG=i,e.START_Y=n.pageY,e.CURR_Y=n.pageY,$(e.ROWS_LINKS[e.CURRENT_DRAG]).addClass(e.CLASS_NAME+"__row-now-dragging")}),400)},n=function(t){if(!e.BEHAVIORS_MODE)return!1;if(e.TOUCH_MOVED=!0,t.targetTouches.length>1||!e.START_DRAG)return e.TMR_LONG_PRESS&&clearTimeout(e.TMR_LONG_PRESS),!1;var n=t.targetTouches[0],i=e.get_index_row(n.pageY);e.OVER_DRAG=i,e.CURR_Y=n.pageY,e.drag_row(),e.quick_repos()},i=function(){if(e.TMR_LONG_PRESS&&clearTimeout(e.TMR_LONG_PRESS),null===e.ROW_HAVE_TOCHED)return!1;if(e.START_DRAG)e.parking_current();else if(!e.TOUCH_MOVED){e.rowCloseAll();var t=e.ALLROWS[e.ROW_HAVE_TOCHED];e.onTouchend&&e.onTouchend(t)}};this.$parent[0].addEventListener("touchstart",t,!!$.supportsPassive()&&{passive:!0}),this.$parent[0].addEventListener("touchmove",n,!!$.supportsPassive()&&{passive:!0}),this.$parent[0].addEventListener("touchend",i,!1),this.$parent[0].addEventListener("touchcancel",i,!1),this.$parent.on("contextmenu",!1),this.$parent.swipe({preventDefault:!1,enableMouse:!1,distance:30,onSwipe:function(t){if(!e.BEHAVIORS_MODE)return!1;var n=$(e.ROWS_LINKS[e.ROW_HAVE_TOCHED]);"left"===t.direction?(e.rowCloseSilblings(n),e.rowOpenRight(n)):"right"===t.direction&&(e.rowCloseSilblings(n),e.rowOpenLeft(n))}}),this.onReady&&this.onReady()},drag_row:function(){var e=this;setTimeout((function(){var t=e.$parent.scrollTop()-e.START_SCROLLTOP;e.CURRENT_DELTA=e.CURR_Y-e.START_Y+t;var n=e.get_row_height()*(e.CURRENT_DRAG+1)*-1-10,i=e.get_row_height()*(e.ROWS_LINKS.length-e.CURRENT_DRAG)+10;e.CURRENT_DELTA>n&&e.CURRENT_DELTA<i&&$(e.ROWS_LINKS[e.CURRENT_DRAG]).css({transform:"translate3d(0,"+e.CURRENT_DELTA+"px, 0)",transition:"0s"})}),0)},quick_repos:function(){var e=this,t=function(t){t!==e.CURRENT_DRAG&&$(e.ROWS_LINKS[t]).css({transform:"translate3d(0, "+e.get_row_height()+"px, 0 )",transition:".3s"})},n=function(t){t!==e.CURRENT_DRAG&&$(e.ROWS_LINKS[t]).css({transform:"translate3d(0,0,0)",transition:".3s"})},i=function(t){$(e.ROWS_LINKS[t]).css({transform:"translate3d(0,-"+e.get_row_height()+"px,0)",transition:".3s"})};requestAnimationFrame((function(){$(e.ROWS_LINKS).each((function(s){e.CURRENT_DRAG>e.OVER_DRAG?s>e.OVER_DRAG-1&&s<e.CURRENT_DRAG?t(s):n(s):e.CURRENT_DRAG==e.OVER_DRAG?n(s):e.CURRENT_DRAG<e.OVER_DRAG&&(s<e.OVER_DRAG+1&&s>e.CURRENT_DRAG?i(s):n(s))}))}))},stop_behaviors:function(){this.$wrapper.addClass("protected"),this.BEHAVIORS_MODE=!1},start_behaviors:function(){this.$wrapper.removeClass("protected"),this.BEHAVIORS_MODE=!0},startRemove:function(e,t){var n=this.get_index_by_id(e);n<0?console.log("unknown row index"):(this.stop_behaviors(),$(this.ROWS_LINKS[n]).addClass("prepare-to-remove"),t.onReady&&t.onReady())},cancelRemoving:function(e){var t=this.get_index_by_id(e);t<0?console.log("unknown row index"):($(this.ROWS_LINKS[t]).removeClass("prepare-to-remove"),this.rowCloseAll(),this.start_behaviors())},endRemove:function(e){var t=this,n=this.get_index_by_id(e),i={closeLeftButton:function(){if(void 0!==n){var e=$(t.ROWS_LINKS[n]);e.css({transform:"translate3d(0,0,0)",transition:".3s"}),setTimeout((function(){i.removeFromArr(e)}),300)}else console.log("unknown row index")},removeFromArr:function(e){e.remove(),setTimeout((function(){t.ROWS_LINKS.splice(n,1),t.ALLROWS.splice(n,1),console.log("after removed",t.ALLROWS);for(var e=n;e<t.ROWS_LINKS.length;e++){$(t.ROWS_LINKS[e]).css({transform:"translate3d(0,-"+t.get_row_height()+"px,0)",transition:".6s cubic-bezier(0.075, 0.82, 0.165, 1)"})}setTimeout((function(){t.redraw_list()}),600)}),0)}};i.closeLeftButton()},parking_current:function(){var e=this;this.stop_behaviors(),console.log("START PARKING");var t,n,i,s=$(this.ROWS_LINKS[this.CURRENT_DRAG]),a=-(e.CURRENT_DRAG-e.OVER_DRAG)*e.get_row_height(),o=300/(this.CURRENT_DELTA-a);t=function(t){var n=e.CURRENT_DELTA-t/o;n>a&&(n=a),s.css({transform:"translate3d(0,"+n+"px,0)",transition:"0s"})},n=300,i=performance.now(),requestAnimationFrame((function e(s){var a=s-i;a>n&&(a=n),t(a),a<n&&requestAnimationFrame(e)})),e.START_DRAG=!1,setTimeout((function(){s.removeClass(e.CLASS_NAME+"__row-now-dragging"),e.CURRENT_DRAG==e.OVER_DRAG?e.start_behaviors():(console.log("reorder"),e.reorder_all())}),300)},reorder_all:function(){var e=this.ALLROWS.splice(this.CURRENT_DRAG,1);this.ALLROWS.splice(this.OVER_DRAG,0,e[0]);e=this.ROWS_LINKS.splice(this.CURRENT_DRAG,1);this.ROWS_LINKS.splice(this.OVER_DRAG,0,e[0]),this.need2save&&this.need2save(!0),this.redraw_list()},redraw_list:function(){var e=this,t=$("<div>",{class:this.CLASS_NAME+"-wrapper"});$.each(e.ALLROWS,(function(n){var i=e.build_new_row(n,this);t.append(i)})),this.$parent.append(t),setTimeout((function(){e.$wrapper.remove(),e.$wrapper=t,e.ROWS_LINKS=e.$wrapper.find("."+e.CLASS_NAME+"__row").toArray(),e.update_height_content({onReady:function(){console.log("!!!"),e.start_behaviors()}})}),300)},rowOpenRight:function(e){e.hasClass("leftOpened")?this.rowCloseLeft(e):!e.hasClass("rightOpened")&&this.BUTTONS.right&&(this.BUTTONS_HAVE_OPENED=!0,e.addClass("rightOpened"),e.css({transform:"translate3d(-"+this.BUTTON_WIDTH*this.BUTTONS.right.length+"px,0,0)",transition:".3s"}))},rowOpenLeft:function(e){e.hasClass("rightOpened")?this.rowCloseRight(e):!e.hasClass("leftOpened")&&this.BUTTONS.left&&(this.BUTTONS_HAVE_OPENED=!0,e.addClass("leftOpened"),e.css({transform:"translate3d("+this.BUTTON_WIDTH*this.BUTTONS.left.length+"px,0,0)",transition:".3s"}))},rowCloseAll:function(){var e=this;this.BUTTONS_HAVE_OPENED=!1,$(this.ROWS_LINKS).each((function(){e.rowCloseLeft($(this)),e.rowCloseRight($(this))}))},rowCloseSilblings:function(e){var t=this;e.siblings().each((function(){$(this).hasClass("rightOpened")&&t.rowCloseRight($(this)),$(this).hasClass("leftOpened")&&t.rowCloseLeft($(this))}))},rowCloseRight:function(e){e.hasClass("rightOpened")&&(this.BUTTONS_HAVE_OPENED=!1,e.css({transform:"translate3d(0,0,0)",transition:".3s"}),e.removeClass("rightOpened"))},rowCloseLeft:function(e){e.hasClass("leftOpened")&&(this.BUTTONS_HAVE_OPENED=!1,e.css({transform:"translate3d(0,0,0)",transition:".3s"}),e.removeClass("leftOpened"))}};this.stopBehaviors=function(){t.stop_behaviors()},this.startBehaviors=function(){t.start_behaviors()},this.updateMenu=function(e){t.update_menu(e)},this.addMenu=function(e){t.add_menu(e)},this.closeAll=function(){t.rowCloseAll()},t.init()}}}),$.extend({superPageList2:function(e){return new function(){var t=this,n=e.$parent,i=e.ALLITEMS||[],s=e.on_resize,a=e.Pages||"",o=e.move2end,r=$(window).width(),c=0;a&&(i=a.get()),console.log("ALLITEMS",i),console.log("Pages",a);var l,_,h,u,p="super-pagelist",d=p+"-bhv-layer",f=p+"-pages-layer",g=$("<div>",{class:p}),v=$("<div>",{class:p+"-protect-left"}),m=$("<div>",{class:p+"-protect-right"}),R=$("<div>",{class:d});n.html("").css({position:"relative"}).append(R.append(g).append(v).append(m));var T=0,S=0,A=0,E=[],w=!1,O=!1,C=!1;a&&a.setCurrent(c);var N={build:function(){t.reset(),g.html("").css({transform:"translateX(15px) translateZ(0)",transition:0,opacity:0}),N.update_page_param({onReady:function(){T=Math.floor((_-h)/2),l=$("<div>",{class:f}),N.insert_pages(),l.appendTo(g),l.css({left:T+"px"}),v.css({width:T+"px"}),m.css({width:T+"px"}),o&&N.to_end(),setTimeout((function(){g.css({transform:"translateX(0) translateZ(0)",transition:".6s",opacity:1})}),150),N.behaviors()}})},prevent_bhvr:function(){return C},insert_pages:function(){for(var e=0;e<N.get_total();e++){var t=e==c?" current ":"",n=e==c?1e4:10*e,s=N.get_x_for_pos(e),a=$("<div>",{class:p+"-page"+t,"data-pos":e}).css({width:h,transform:"translateX("+s+"px) translateZ(0)",zIndex:n}).append(i[e]);l.append(a)}E=l.find("."+p+"-page").toArray()},add_new_page:function(e){var t=i.length-1,n=10*t,s=N.get_x_for_pos(t-c),a=$("<div>",{class:p+"-page current","data-pos":t}).css({width:h,transform:"translateX("+s+"px) translateZ(0)",zIndex:n}).append(i[t]);l.append(a),E.push(a),setTimeout((function(){N.to_end(),setTimeout((function(){e&&e()}),300)}),300)},update_page_param:function(e){_=parseInt(n.width(),10),h=Math.floor(_/1.7),u=10,e.onReady&&e.onReady()},get_total:function(){return i.length},behaviors:function(){var e=this;R.swipe({preventDefault:!1,enableMouse:!1,distance:30,onSwipe:function(e){if(N.prevent_bhvr())return!1;"left"===e.direction?w?N.change_pos_next():N.to_next():"right"===e.direction?w?N.change_pos_prev():N.to_prev():"up"===e.direction&&N.is_touchstart_on_page()?(O?(O=!1,N.mode_pre_remove(O)):(w=!0,N.mode_reposition_pages(w)),a&&a.onSwipeUp()):"down"===e.direction&&N.is_touchstart_on_page()&&(w?(w=!1,N.mode_reposition_pages(w),a&&a.updatePosition(c)):(O=!0,N.mode_pre_remove(O)),a&&a.onSwipeDown())}}),R.on("touchstart",(function(e){S=0;var t=e.originalEvent;if(!(t.targetTouches.length>1)){var n=t.targetTouches[0];A=n.pageX,n.pageY}})),R.on("touchend",(function(e){if(N.prevent_bhvr())return!1;S||(N.is_touchstart_on_page()?w||O||a&&a.onTouchend(c):N.on_touch_around()),e.originalEvent.cancelable&&e.preventDefault()})),R.on("touchmove",(function(e){if(N.prevent_bhvr())return!1;S=1;var t=e.originalEvent;t.targetTouches.length>1||(t.targetTouches[0],e.stopPropagation())})),$(window).resize((function(){null!==e.TMR_RESIZE&&clearTimeout(e.TMR_RESIZE),e.TMR_RESIZE=setTimeout((function(){r!==$(window).width()&&s&&s(),e.TMR_RESIZE=null}),300)}))},mode_pre_remove:function(e){requestAnimationFrame((function(){e?n.addClass("mode-pre-remove"):n.removeClass("mode-pre-remove")}))},mode_reposition_pages:function(e){e?n.addClass("mode-reposition"):n.removeClass("mode-reposition")},is_touchstart_on_page:function(){var e=Math.floor((_-h)/2);return A>e&&A<e+h},on_touch_around:function(){var e=Math.floor((_-h)/2);A<e+u?w?N.change_pos_prev():N.to_prev():A>_-e&&(w?N.change_pos_next():N.to_next())},to_end:function(){i.length>1&&(c=i.length-1,N.go_to())},to_prev:function(){c>0?(c--,N.go_to()):N.cant_prev()},to_next:function(){c<N.get_total()-1?(c++,N.go_to()):N.cant_next()},cant_play:function(e,t){requestAnimationFrame((function(){g.css({transform:"translateX("+e+") translateZ(0)",transition:t})}))},cant_prev:function(){N.cant_play("15px","0.1s"),setTimeout((function(){N.cant_play("0px","1s")}),200)},cant_next:function(){N.cant_play("-15px","0.1s"),setTimeout((function(){N.cant_play("0px","1s")}),200)},go_to:function(){N.mode_pre_remove(!1),a&&a.setCurrent(c),$.each(E,(function(e){var t=N.get_x_for_pos(e-c);$(this).removeClass("current").css({transform:"translateX("+t+"px) translateZ(0)",zIndex:10*e})})),$(E[c]).addClass("current").css({zIndex:1e3})},get_x_for_pos:function(e){return e*h+e*u},change_pos_next:function(){c<N.get_total()-1?requestAnimationFrame((function(){$.each(E,(function(e){e!=c&&$(this).css({transform:"translateX("+N.get_x_for_pos(e-(c+1))+"px) translateZ(0)"}),e==c+1&&$(this).css({transform:"translateX("+N.get_x_for_pos(e-(c+2))+"px) translateZ(0)"})}));var e=E.splice(c,1);E.splice(c+1,0,e[0]),c+=1,a&&a.updatePosition(c)})):N.cant_next()},change_pos_prev:function(){c>0?requestAnimationFrame((function(){$.each(E,(function(e){e!=c&&$(this).css({transform:"translateX("+N.get_x_for_pos(e-(c-1))+"px) translateZ(0)"}),e==c-1&&$(this).css({transform:"translateX("+N.get_x_for_pos(e-(c-2))+"px) translateZ(0)"})}));var e=E.splice(c,1);E.splice(c-1,0,e[0]),c-=1,a&&a.updatePosition(c)})):N.cant_prev()},update_pos_after_deleting:function(e){e=parseInt(e,10);var t=function(){E.splice(e,1),i.length&&i.splice(e,1)};if(1===E.length)t();else if(e<E.length-1){for(var n=e;n<E.length;n++){var s=n==e+1?1e3:10*(n-1),o=(n-c-1)*h+(n-c-1)*u;$(E[n]).css({transform:"translateX("+o+"px) translateZ(0)",zIndex:s}),n==e+1&&$(E[n]).addClass("current")}t()}else if(e==E.length-1){for(n=e-1;n>-1;n--){s=n==e-1?1e3:10*n,o=(n-c+1)*h+(n-c+1)*u;$(E[n]).css({transform:"translateX("+o+"px) translateZ(0)",zIndex:s}),n==e-1&&$(E[n]).addClass("current")}t(),c-=1,a&&a.setCurrent(c)}}};$.extend(this,{reset:function(e){var t=w||O?300:0;w=!1,O=!1,N.mode_pre_remove(!1),N.mode_reposition_pages(!1),a&&a.stateDefault(),setTimeout((function(){e&&e.onReady&&e.onReady()}),t)},change_pos_next:function(){N.change_pos_next()},change_pos_prev:function(){N.change_pos_prev()},removeCurrentPage:function(e){var t=this;this.lock_behaviors(!0);var n=c;$(E[n]).css({transform:"scale(.1)",opacity:0,transition:".6s .3s"}),setTimeout((function(){N.update_pos_after_deleting(n),setTimeout((function(){t.lock_behaviors(!1),e.onReady&&e.onReady()}),300)}),600)},lock_behaviors:function(e){C=!!e},updateAfterAdd:function(e){N.add_new_page(e)},hide:function(e,t){if(t){var n=l.find("."+p+"-page"),i=[c-1,c,c+1];(n=n.not(":eq("+i[0]+"), :eq("+i[1]+"), :eq("+i[2]+")")).size()&&n.remove()}e=e?e/1e3+"s":".6s";g&&g.css({transform:"translateX(15px) translateZ(0)",transition:e,opacity:0})}}),setTimeout((function(){N.build()}),100)}}}),$.extend({menuItems:function(e){return new function(){var t=e.arr||[],n=e.tpl||"",i=e.need2Save,s=e.need2SavePos,a=e.saveItem,o=e.saveItemsPos,r=e.itemEdit,c=e.itemImageEdit,l=e.itemDelete,_=e.currencySign,h=e.itemReplace,u=e.itemReplace;if(!n)return!1;var p=[],d=0,f=0,g=!1,v=!1,m=!1,R=!1,T=!1,S=[],A={build:function(){$.each(t,(function(e){var i=n.clone();i=A.fill_with_content(i,t[e]),S.push(i)})),A.behaviors(),A.start_load_images()},fill_with_content:function(e,t){var n="iiko"==t.created_by;if(n){var i=[],s=t.iiko_sizes?JSON.parse(t.iiko_sizes):[];for(var a in s)i.push(s[a].price);var o=i.join("/")}else{const e=[],n=t.sizes?JSON.parse(t.sizes):[];if(n.length)for(let t in n)e.push(n[t].price);else e.push(0);o=e.join("/")}var r=t.title||"",c=t.description||"",l=t.volume||"",h=o+"&nbsp;"+_;return e.find(".item-title > div").html(r),e.find(".item-description").html(c+"<div class='item-volume'>"+l+"</div>"),e.find(".item-price > div").html(h),parseInt(t.mode_spicy,10)&&e.addClass("flag-spicy-enable"),parseInt(t.mode_hit,10)&&e.addClass("flag-hit-enable"),parseInt(t.mode_vege,10)&&e.addClass("flag-vege-enable"),t.image_url&&e.addClass("image-available"),u&&!n&&e.addClass("item-highlighted"),e.addClass("item-"+t.id),e.attr({"data-item-id":t.id}),e},behaviors:function(e){var n=function(){return!f&&g&&(this.$pageParent.toggleClass("flag-spicy-enable"),t[d].mode_spicy=this.$pageParent.hasClass("flag-spicy-enable")?1:0,i&&i(t[d]),m=!0),!1},s=function(){return!f&&g&&(this.$pageParent.toggleClass("flag-hit-enable"),t[d].mode_hit=this.$pageParent.hasClass("flag-hit-enable")?1:0,i&&i(t[d]),m=!0),!1},a=function(){return!f&&g&&(this.$pageParent.toggleClass("flag-vege-enable"),t[d].mode_vege=this.$pageParent.hasClass("flag-vege-enable")?1:0,i&&i(t[d]),m=!0),!1},o=function(e){var i;e.on("touchstart",(function(e){f=0})),e.on("touchmove",(function(e){f=1})),e.find(".small-item-image").on("touchend",(function(e){!f&&c&&c(t[d]),e.originalEvent.cancelable&&e.preventDefault(),e.stopPropagation()})),(i=e.find(".btn-flag-spicy")[0]).addEventListener("touchend",n,!1),i.$pageParent=e,(i=e.find(".btn-flag-hit")[0]).addEventListener("touchend",s,!1),i.$pageParent=e,(i=e.find(".btn-flag-vege")[0]).addEventListener("touchend",a,!1),i.$pageParent=e,e.find(".btns-item-repos__prev").on("touchend",(function(e){return!f&&g&&h&&h("prev"),!1})),e.find(".btns-item-repos__next").on("touchend",(function(e){return!f&&g&&h&&h("next"),!1})),e.find(".btn-item-delete").on("touchend",(function(){return!f&&v&&l&&l(t[d],d),!1}))};if(null==e)$.each(S,(function(){o(this)}));else{var r=!1;for(var _ in S){var u="item-"+e.id;if(S[_].hasClass(u)){r=S[_];break}}r&&o(r)}},page_down_mode_start:function(e){requestAnimationFrame((function(){v=!0,e&&e.addClass("pagedownmode")}))},page_down_mode_end:function(e){requestAnimationFrame((function(){v=!1,e&&e.removeClass("pagedownmode")}))},page_up_mode_start:function(e){requestAnimationFrame((function(){g=!0,e&&e.addClass("pageupmode")}))},page_up_mode_end:function(e){requestAnimationFrame((function(){g=!1,e&&e.removeClass("pageupmode"),A.save()}))},save:function(){m?a&&a(t[d]):R&&o&&o(),m=!1,R=!1},reset_all_pages:function(){m=!1,R=!1,$.each(S,(function(e){A.page_up_mode_end($(this)),A.page_down_mode_end($(this))}))},start_load_images:function(){T=!1,p=[],$.each(t,(function(){this.image_url&&p.push(this)}));var e={next_load_image:function(){var t=p.shift();t?A.load_image(t,(function(){e.next_load_image()})):T=!1}};setTimeout((function(){$.each(S,(function(e){var n=$(this).find(".small-item-image__loader");t[e]&&t[e].image_url&&n.removeClass("hidden")})),e.next_load_image()}),300)},load_image:function(e,t){var n=e.image_url.replace(".jpg","-s.jpg");(T=new Image).onload=function(){A.replace_image(e.id,this),t&&t()},T.src=n},replace_image:function(e,t){setTimeout((function(){$.each(S,(function(){this.hasClass("item-"+e)&&this.find(".small-item-image__holder").css({backgroundImage:"url('"+t.src+"')"}).removeClass("hidden").end().find(".small-item-image__loader").addClass("hidden")}))}),500)}};A.build(),$.extend(this,{get:function(){return S},setCurrent:function(e){d!=e&&(d=e,A.reset_all_pages())},onTouchend:function(e){r&&r(t[d])},stopLoadingImages:function(){T&&(T.onload=function(){},T.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",console.log("stop loading!"))},updateImageForCurrent:function(){var e=t[d],n=S[d].find(".small-item-image__loader");e&&e.image_url&&n.removeClass("hidden"),A.load_image(e,!1)},updateItem:function(e){var t="item-"+e.id,n=!1;for(var i in S)if(S[i].hasClass(t)){n=S[i];break}n&&A.fill_with_content(n,e)},updatePosition:function(e){if(e!=d){var n=S.splice(d,1);S.splice(e,0,n[0]);var i=t.splice(d,1);t.splice(e,0,i[0]),d=e,R=!0,s&&s()}},updateAfterAdd:function(e){if(t.length){var i=t[t.length-1],s=n.clone();s=A.fill_with_content(s,i),S.push(s),A.behaviors(i),e&&e()}},onSwipeUp:function(){v?A.page_down_mode_end(S[d]):A.page_up_mode_start(S[d])},onSwipeDown:function(){g?(A.page_up_mode_end(S[d]),console.log("page_up_mode_end 1 in menuItems")):A.page_down_mode_start(S[d])},stateDefault:function(){A.reset_all_pages()}})}}}),$.clear_user_input=function(e,t){t=t||100;return e=(e=(e=(e=e).replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")).substr(0,t)).replace(/<[^>]*>?/gm,"")}}();
